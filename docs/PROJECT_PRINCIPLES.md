# libx-dev リポジトリ開発原則（草案）

## リポジトリの目的
- Astroベースのモノレポ構造で複数のドキュメントサイトを一元管理し、共通のUI/テーマを共有した一貫した体験を提供する。
- OSS技術文書を主に英語から日本語へ翻訳し、学習コストを下げるとともに、多言語展開にも対応する。
- libx-dev（開発基盤）・libx-core（抽出されたコア）・libx-docs（コンテンツ）の三リポジトリ連携を維持し、継続的に改善・同期する。

## 基本姿勢
1. **アクセス性と翻訳品質の両立**: 多言語対応を前提に、特に日本語訳の読みやすさと正確さを優先する。
2. **一貫したユーザー体験**: 共有コンポーネントとテーマを通じて、どのアプリでも同じ情報設計と操作感を守る。
3. **再利用を前提とした設計**: project-template を起点に、新規プロジェクトでも共通のベストプラクティスを踏襲できるよう保つ。
4. **自動化による信頼性**: スクリプト（create-*、add-language、build-integrated、sync-content 等）を積極的に活用し、人手によるばらつきを減らす。

## 開発・運用原則
- `pnpm` ワークスペースを基盤としたモノレポ構成を壊さず、依存関係や設定変更は共有パッケージとの整合性を確認して行う。
- 共有パッケージ（`@docs/ui`, `@docs/theme`, `@docs/i18n`, `@docs/versioning`）を起点に機能を追加し、重複実装を避ける。
- ファイルベースの自動化（ナビゲーション生成や同期スクリプト）に依存しているため、ディレクトリ構造・命名規則・プレフィックスの一貫性を保ち、手作業変更時は自動化への影響を検証する。
- 新しいUI/UX要素やユーティリティを追加する際は、共有レイヤー（`@docs/ui`, `@docs/theme`, 共通CSS、共有ユーティリティ）を優先して拡張し、プロジェクト固有の実装は理由と影響範囲を記録したうえで最小限に留める。
- Cloudflare Pages を前提としたビルド／デプロイパイプライン（`pnpm build:deploy`, `pnpm deploy:pages` 等）の整合性を常に確かめる。
- `libx-core` との同期スクリプト（`sync-to-libx-core.js` 等）で抽出対象を保護し、履歴が汚れないようにする。

## コンテンツ運用原則
- バージョン・言語・カテゴリをディレクトリで明示し、`01-` 形式の番号プレフィックスでナビゲーション順を統一する。
- libx-docs との同期を前提とし、`sync-content.js` と `validate-content.js` を活用して構造の対称性と欠落の有無を検証する。
- 翻訳コンテンツの追加時は `create-document.js` や `add-language.js` を用い、設定ファイル（`project.config.json`, `projects.config.json`）の整合性を自動更新する。
- 新規プロジェクトはテンプレートから生成し、テンプレート自体の変更は十分なレビューとテストを経てから反映する。

### 命名規則チェックリスト
- [ ] ルート構成は `apps/<project>/src/content/docs/<version>/<lang>/` を守り、`<version>` は `v1` 形式で `project.config.json` の定義に一致している。
- [ ] `<lang>` ディレクトリは ISO コード（例: `en`, `ja`, `zh-Hans`）を使用し、`supportedLangs` と一致している。
- [ ] カテゴリディレクトリは `NN-slug`（例: `01-guide`）形式でゼロ埋め連番を採用し、各言語で同一構造を維持している。
- [ ] ドキュメントファイルは `NN-slug.mdx`（例: `02-setup-and-structure.mdx`）形式でゼロ埋め連番を付け、カテゴリ内で重複がない。
- [ ] スラッグ部分は英小文字・ハイフン区切りを基本とし、翻訳済みファイルでも構造が変わらない。
- [ ] 自動生成されるサイドバーやナビゲーションに影響する変更（番号、構造、スラッグ）を行った場合は `pnpm build:sidebar` などで結果を検証する。

## 自動化と品質保証
- ビルド／同期／生成系スクリプトはドライラン (`--dry-run`) やバリデーションオプションを活用し、安全に手順を踏む。
- 変更時は最低限 `pnpm lint` と `pnpm build`（必要に応じて `pnpm build:sidebar` や `pnpm build:local`）で破壊的変更がないか確認する。
- 共有パッケージやテンプレートに手を入れる際は複数アプリ（sample-docs, top-page, project-template, test-verification）で動作を確かめる。
- 自動生成ファイルや同期結果は Git 差分を確認し、不要な変更（番号順や翻訳マーカーの欠落等）を残さない。

## 法務・ライセンス遵守
- 翻訳元文書のライセンスは `docs/LICENSE_GUIDELINES.md` に基づき確認し、再配布・翻訳が許可されたもののみを取り込む。
- `project.config.json` の `licensing` 情報を更新し、帰属表示とライセンスURLを明示する。
- 不明瞭なライセンスや再配布不可の素材は取り込まない。必要な場合は別途法的確認を行う。

## コラボレーションとドキュメント
- 新しい操作フローやスクリプトが追加された場合は `README.md` や docs 配下のガイドを更新し、利用者の学習コストを下げる。
- 作業手順や判断の背景は PR やドキュメントに記録し、将来の維持管理者が追跡できるようにする。
- テンプレートや共有コンポーネントの変更は利用プロジェクトへの影響範囲を明示し、段階的な反映を計画する。
- 三リポジトリ構成（libx-dev/libx-core/libx-docs）での役割分担を定期的に見直し、同期や移行に関する手順を随時アップデートする。

---
本草案はリポジトリの現状理解をもとにした初期案です。運用状況や関係リポジトリの変化に応じて、定期的に見直し・更新してください。
