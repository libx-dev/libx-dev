# 移行リスクログ

**作成日**: 2025-10-21
**最終更新**: 2025-10-21
**Phase**: 3-5（移行作業計画）

---

## 📋 目次

1. [概要](#概要)
2. [リスク評価基準](#リスク評価基準)
3. [リスク一覧](#リスク一覧)
4. [プロジェクト別リスク](#プロジェクト別リスク)
5. [緩和策とアクションプラン](#緩和策とアクションプラン)
6. [リスク追跡ログ](#リスク追跡ログ)

---

## 概要

このドキュメントは、libx-devプロジェクトから新レジストリ形式への移行作業における潜在的なリスクを特定し、緩和策を定義します。

### リスク管理の目的

- 移行作業の失敗を防止
- データ損失の回避
- 予期しない問題の早期発見
- 移行スケジュールの遵守

### リスク管理プロセス

1. **リスク特定**: 潜在的な問題の洗い出し
2. **リスク評価**: 影響度と発生確率の評価
3. **緩和策定義**: 対策とアクションプランの作成
4. **リスク追跡**: 継続的なモニタリングと更新

---

## リスク評価基準

### 影響度

| レベル | 説明 | 例 |
|-------|------|---|
| **🔴 高** | プロジェクト全体に重大な影響 | データ損失、移行失敗、サービス停止 |
| **🟡 中** | 一部機能に影響、追加作業が必要 | 一部コンテンツの未変換、互換性問題 |
| **🟢 低** | 軽微な影響、容易に対処可能 | 警告メッセージ、軽微な設定ミス |

### 発生確率

| レベル | 説明 | 確率 |
|-------|------|------|
| **高** | 発生する可能性が高い | 50%以上 |
| **中** | 発生する可能性がある | 20-50% |
| **低** | 発生する可能性は低い | 20%未満 |

### リスクスコア

```
リスクスコア = 影響度 × 発生確率
```

| スコア | 優先度 | 対応方針 |
|-------|--------|---------|
| **高 × 高** | 🔴 最優先 | 即座に緩和策を実施 |
| **高 × 中** | 🟡 優先 | 緩和策を計画・実施 |
| **中 × 高** | 🟡 優先 | 緩和策を計画・実施 |
| **その他** | 🟢 監視 | 継続的にモニタリング |

---

## リスク一覧

### R1: データ損失リスク（🔴 最優先）

**カテゴリ**: データ管理

**説明**:
移行作業中にコンテンツファイルやメタデータが失われる可能性。

**影響度**: 🔴 高
**発生確率**: 低
**リスクスコア**: 🟡 中

**緩和策**:
1. ✅ `.backups/`ディレクトリで自動バックアップ（最大20世代）
2. ✅ Dry-runモードで事前確認（変更を実際には行わない）
3. ✅ Migration WorkflowでArtifacts保存（30-60日保持）
4. ✅ ロールバック手順の文書化

**検出方法**:
- Migration Workflowの互換性チェックログ確認
- Artifactsからの移行レポート確認
- ビルドテスト結果の確認

**ステータス**: ⬜ 未発生

---

### R2: 互換性問題（🟡 優先）

**カテゴリ**: 技術

**説明**:
既存の設定ファイルやコンテンツ構造が新レジストリ形式と互換性がない可能性。

**影響度**: 🟡 中
**発生確率**: 中
**リスクスコア**: 🟡 中

**緩和策**:
1. ✅ `docs-cli compat check`で事前検出
2. ✅ 互換性チェックログの自動生成
3. ✅ 互換ラッパースクリプトの提供（2026-03-31まで）
4. ⚠️ 互換性問題の早期発見（Sprint 1で検証）

**検出方法**:
- `docs-cli compat check`実行
- Migration Workflowの互換性チェックジョブ
- PRへの自動コメント通知

**ステータス**: ⬜ 未発生

---

### R3: 未翻訳コンテンツ（🟡 優先）

**カテゴリ**: コンテンツ

**説明**:
一部言語でコンテンツが未翻訳または欠損している可能性（特にko言語）。

**影響度**: 🟡 中
**発生確率**: 高
**リスクスコア**: 🟡 優先

**緩和策**:
1. ✅ 移行時に`status: "missing"`で記録
2. ✅ 言語間ディレクトリ構造の整合性チェック
3. ⚠️ 未翻訳コンテンツリストの生成
4. ⚠️ 翻訳ステータスの可視化

**検出方法**:
- ファイルスキャン時の存在確認
- 言語間のファイル数比較
- 移行レポートでの未翻訳リスト確認

**ステータス**: ⬜ 未発生（Sprint 2で検証予定）

---

### R4: ビルドエラー（🟡 優先）

**カテゴリ**: 技術

**説明**:
変換後のレジストリ形式でビルドが失敗する可能性。

**影響度**: 🟡 中
**発生確率**: 中
**リスクスコア**: 🟡 中

**緩和策**:
1. ✅ Migration Workflowで自動ビルドテスト
2. ✅ スキーマバリデーションの自動実行
3. ✅ ビルドログのArtifacts保存
4. ⚠️ エラー時の自動通知（PR通知）

**検出方法**:
- Migration Workflowのビルドジョブ結果
- ビルドログの確認
- GitHub Actions Summary

**ステータス**: ⬜ 未発生

---

### R5: ライセンス情報の不備（🟡 優先）

**カテゴリ**: 法務・ライセンス

**説明**:
ライセンス情報が欠損または不正確な可能性（特にlibx-docs）。

**影響度**: 🟡 中
**発生確率**: 低
**リスクスコア**: 🟢 低

**緩和策**:
1. ✅ project.config.jsonのlicensingセクション確認
2. ⚠️ ライセンスIDの整合性チェック
3. ⚠️ 移行レポートでのライセンス情報レビュー
4. ⚠️ 必要に応じて手動補正

**検出方法**:
- 互換性チェックでのライセンス情報確認
- 移行レポートでの警告メッセージ
- 手動レビュー

**ステータス**: ⬜ 未発生（Sprint 3で確認予定）

---

### R6: libx-docs同期状態の不一致（🟡 優先）

**カテゴリ**: データ管理

**説明**:
libx-docsリポジトリとlibx-dev/apps/libx-docsの同期状態が不一致の可能性。

**影響度**: 🟡 中
**発生確率**: 中
**リスクスコア**: 🟡 中

**緩和策**:
1. ⚠️ libx-docsリポジトリとの最終同期確認（Sprint 3開始前）
2. ⚠️ syncHashによる差分検出
3. ⚠️ 手動での整合性確認
4. ⚠️ 不一致箇所のドキュメント化

**検出方法**:
- syncHashの比較
- Git履歴の確認
- ファイルの差分確認

**ステータス**: ⬜ 未発生（Sprint 3で確認予定）

---

### R7: 手動作業の増加（🟢 監視）

**カテゴリ**: 運用

**説明**:
自動変換の精度不足により、手動補正作業が増加する可能性。

**影響度**: 🟢 低
**発生確率**: 中
**リスクスコア**: 🟢 低

**緩和策**:
1. ✅ Dry-runモードで事前確認
2. ✅ 変換プレビューと手動補正手順の明示
3. ⚠️ 手動補正箇所の記録
4. ⚠️ 次回移行時の改善に反映

**検出方法**:
- 移行レポートでの警告カウント
- 手動補正箇所の記録
- 作業時間の計測

**ステータス**: ⬜ 未発生

---

### R8: CI環境の設定ミス（🟢 監視）

**カテゴリ**: 技術

**説明**:
.docs-cli/config.ci.jsonやGitHub Actionsの設定ミスにより、Migration Workflowが正常に動作しない可能性。

**影響度**: 🟢 低
**発生確率**: 低
**リスクスコア**: 🟢 低

**緩和策**:
1. ✅ Sprint 1開始前にDry-runでテスト実行
2. ✅ config.ci.example.jsonでサンプル提供
3. ✅ CIガイドでの詳細説明
4. ⚠️ エラー時のトラブルシューティング手順

**検出方法**:
- Migration Workflowの実行結果
- GitHub Actions Summary
- エラーログの確認

**ステータス**: ⬜ 未発生

---

### R9: バックアップ肥大化（🟢 監視）

**カテゴリ**: 運用

**説明**:
.backups/ディレクトリが肥大化し、ストレージを圧迫する可能性。

**影響度**: 🟢 低
**発生確率**: 高
**リスクスコア**: 🟢 低

**緩和策**:
1. ✅ maxBackups設定で世代管理（最大20世代）
2. ✅ 定期的なクリーンアップ手順の提供
3. ⚠️ 古いバックアップの自動削除（30日以上前）
4. ⚠️ 重要なバックアップのArtifacts保存

**検出方法**:
- .backups/ディレクトリのサイズ確認
- バックアップ世代数の確認
- ストレージ使用量の監視

**ステータス**: ⬜ 未発生

---

### R10: スケジュール遅延（🟡 優先）

**カテゴリ**: プロジェクト管理

**説明**:
予期しない問題により、移行スケジュールが遅延する可能性。

**影響度**: 🟡 中
**発生確率**: 中
**リスクスコア**: 🟡 中

**緩和策**:
1. ✅ 各Sprintに予備日を設定
2. ✅ 週次レビューでの進捗確認
3. ⚠️ 早期のエスカレーション（問題発生から2日以内）
4. ⚠️ スケジュール調整の柔軟性確保

**検出方法**:
- 週次レビューでの進捗確認
- タスク完了状況の確認
- ブロッカーの早期報告

**ステータス**: ⬜ 未発生

---

## プロジェクト別リスク

### project-template

**主要リスク**:
- R2: 互換性問題（🟡 中） - 初回テストで検証
- R4: ビルドエラー（🟡 中） - テンプレートの動作確認が重要
- R8: CI環境の設定ミス（🟢 低） - 初回実行で検証

**特記事項**:
- 最小規模のため、リスクは全体的に低い
- Sprint 1で移行手順を確立するための重要なテストケース

---

### test-verification

**主要リスク**:
- R3: 未翻訳コンテンツ（🟡 優先） - 韓国語（ko）の翻訳状況が不明
- R2: 互換性問題（🟡 中） - 3言語対応の検証が必要
- R4: ビルドエラー（🟡 中） - 多言語ビルドの確認

**特記事項**:
- ko言語の翻訳状況を確認する必要あり
- 多言語対応の移行手順を確立するための重要なプロジェクト

---

### sample-docs

**主要リスク**:
- R4: ビルドエラー（🟡 中） - v1/v2の差分管理が必要
- R2: 互換性問題（🟡 中） - 既存registry/docs.jsonとのマージ
- R7: 手動作業の増加（🟢 低） - コンテンツ量が多いため

**特記事項**:
- 既存のregistry/docs.jsonに一部データがあるため、マージ処理が重要
- デモサイトとして活用されるため、品質確保が重要

---

### libx-docs

**主要リスク**:
- R6: libx-docs同期状態の不一致（🟡 優先） - 外部リポジトリとの同期確認
- R5: ライセンス情報の不備（🟡 優先） - ライセンス情報の確認が必要
- R1: データ損失リスク（🔴 高） - 廃止予定のため、最終移行が重要

**特記事項**:
- libx-docsリポジトリとの最終同期が必須
- 廃止に伴う影響範囲の確認が必要
- ライセンス情報の正確性が重要

---

## 緩和策とアクションプラン

### Sprint 1開始前（2025-10-22前）

**アクション**:
1. ✅ GitHub Actions Migration Workflowのテスト実行（Dry-run）
   - 担当: TBD
   - 期限: 2025-10-22
   - 目的: R8（CI環境の設定ミス）の緩和

2. ✅ `.docs-cli/config.ci.json`のカスタマイズ
   - 担当: TBD
   - 期限: 2025-10-22
   - 設定: maxBackups=20, retentionDays=60
   - 目的: R1（データ損失リスク）、R9（バックアップ肥大化）の緩和

3. ✅ バックアップクリーンアップ手順の確認
   - 担当: TBD
   - 期限: 2025-10-22
   - 目的: R9（バックアップ肥大化）の緩和

---

### Sprint 1期間中（2025-10-22〜2025-10-27）

**アクション**:
1. ⚠️ project-template Dry-run実行
   - 担当: TBD
   - 期限: 2025-10-23
   - 目的: R2（互換性問題）、R4（ビルドエラー）の早期発見

2. ⚠️ 互換性チェックログの確認
   - 担当: TBD
   - 期限: 2025-10-24
   - 目的: R2（互換性問題）の検証

3. ⚠️ 移行手順のドキュメント化
   - 担当: TBD
   - 期限: 2025-10-26
   - 目的: R7（手動作業の増加）、R10（スケジュール遅延）の緩和

---

### Sprint 2期間中（2025-10-28〜2025-11-03）

**アクション**:
1. ⚠️ 韓国語（ko）コンテンツの確認
   - 担当: TBD
   - 期限: 2025-10-30
   - 目的: R3（未翻訳コンテンツ）の検証

2. ⚠️ 未翻訳コンテンツリストの生成
   - 担当: TBD
   - 期限: 2025-11-01
   - 目的: R3（未翻訳コンテンツ）の可視化

3. ⚠️ 多言語対応手順の確立
   - 担当: TBD
   - 期限: 2025-11-02
   - 目的: R2（互換性問題）、R4（ビルドエラー）の緩和

---

### Sprint 3期間中（2025-11-04〜2025-11-15）

**アクション**:
1. ⚠️ libx-docsリポジトリとの最終同期確認
   - 担当: TBD
   - 期限: 2025-11-11
   - 目的: R6（libx-docs同期状態の不一致）の緩和

2. ⚠️ ライセンス情報の確認
   - 担当: TBD
   - 期限: 2025-11-13
   - 目的: R5（ライセンス情報の不備）の緩和

3. ⚠️ libx-docs廃止手順のドキュメント化
   - 担当: TBD
   - 期限: 2025-11-15
   - 目的: R1（データ損失リスク）の緩和

---

## リスク追跡ログ

### リスク発生履歴

| 日付 | リスクID | プロジェクト | 詳細 | 対応 | ステータス |
|-----|---------|------------|------|------|----------|
| （未発生） | - | - | - | - | - |

### リスク更新履歴

| 日付 | リスクID | 変更内容 | 更新者 |
|-----|---------|---------|--------|
| 2025-10-21 | - | 初版作成 | Claude Code |

---

## CI/自動化によるリスク検出

### Migration Workflowでの検出

**互換性チェックジョブ**:
- R2: 互換性問題の検出
- R3: 未翻訳コンテンツの検出
- R5: ライセンス情報の不備検出

**ビルドジョブ**:
- R4: ビルドエラーの検出
- R2: 互換性問題の検出

**通知ジョブ**:
- 警告・エラーの自動通知
- PRへの自動コメント

### Artifactでの検出

**migration-reports**:
- 変換統計の確認
- 未翻訳コンテンツリストの確認
- ライセンス情報の確認

**compat-check-log**:
- 互換性問題の詳細確認
- 警告メッセージの確認

**build-logs**:
- ビルドエラーの詳細確認
- エラースタックトレースの確認

---

## 更新履歴

| 日付 | 更新者 | 変更内容 |
|-----|--------|---------|
| 2025-10-21 | Claude Code | 初版作成（Phase 3-5タスク4） |

---

## 関連ドキュメント

- [移行ダッシュボード](./migration-dashboard.md)
- [移行スケジュール](./migration-schedule.md)
- [Phase 3-5計画](../phase-3-5-migration-plan.md)
- [Phase 3-4→3-5引き継ぎ](../phase-3-4-to-3-5-handoff.md)
- [CI実行例](../examples/ci.md)
- [CIガイド](../guides/ci.md)

---

**最終更新**: 2025-10-21
**作成者**: Claude Code (AI Assistant)
