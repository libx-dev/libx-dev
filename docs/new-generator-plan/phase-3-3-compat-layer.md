# フェーズ3-3：互換レイヤー詳細計画

## 目的
- 既存スクリプト（`create-project.js`, `add-language.js`, など）から新 CLI への移行を段階的に進めるため、互換レイヤーを提供する。
- 旧コマンドに慣れた利用者の作業を阻害せず、新 CLI への切り替えを促進する。

## スコープ
- 旧 Node スクリプトの CLI ラッパー化。  
- `.docs-cli/config.json` と互換設定のブリッジ。  
- 互換モードのログ／警告表示、 deprecation ポリシー。

## タスク
1. **ラッパースクリプト実装**
   - 既存 `scripts/*.js` から CLI を呼び出す薄いラッパーを作成（`node scripts/add-language.js` → `docs-cli add-language`）。  
   - 引数・オプションのマッピング、非対応オプションは警告を出す。
2. **設定互換**
   - 旧 `.env` や config JSON から `.docs-cli/config.json` へ移行するスクリプトを用意。  
   - 旧設定が見つかった場合は自動変換または警告を出力。
3. **ログと警告**
   - 互換レイヤー経由で実行された場合に deprecation 警告を表示し、新 CLI のドキュメントへのリンクを案内。
4. **テスト**
   - 旧スクリプト呼び出しの統合テスト（成功・失敗パス）。  
   - CLI との結果差異がないかスナップショット比較。  
   - バックアップ/ロールバックが互換レイヤーからでも機能するか検証。
5. **ドキュメント**
   - 互換レイヤーの使い方とサポート期間を `docs/new-generator-plan/guides/compat-layer.md` に記載。  
   - 警告メッセージの意味と、移行時期・手順を周知。
6. **段階的削除計画**
   - 互換レイヤーの終了タイムラインと条件（例: フェーズ5 完了後 3 ヶ月）。  
   - DECISIONS.md に削除計画を記録し、関係者へ共有。

## 成果物
- `scripts/` 配下の互換ラッパー。  
- 設定移行スクリプト。  
- 互換レイヤーガイド。  
- テストと警告ログ。

## 完了条件
- 旧スクリプトからの呼び出しで CLI が正常動作し、警告表示が行われる。  
- 利用者が新 CLI への移行を進められるようドキュメントとサポートが整備されている。  
- 互換レイヤー終了計画が合意され、DECISIONS.md に記録されている。
