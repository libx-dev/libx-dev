# 新ドキュメントサイトジェネレーター開発原則（草案）

## 1. 目的
- 単一リポジトリで完結するドキュメントサイトジェネレーターを設計・実装し、翻訳中心のワークフローを効率化する。
- 既存の libx-dev の成果物（UI/テーマ、翻訳運用、ビルド知見）を活かしながら、運用の複雑性を低減する。

## 2. 基本姿勢
1. **生成されるサイトから逆算した設計**: 最終的なユーザー体験と情報構造を軸に、レジストリ・ビルド・CLI を設計する。
2. **データ駆動と自動化の両立**: JSON レジストリと CLI を通じて構造を一元管理し、手作業によるばらつきを排除する。
3. **共有資産の最大活用**: libx-dev で成熟した UI/テーマ・翻訳パターンを継承し、再実装を最小限に抑える。
4. **段階的な移行と検証**: 既存コンテンツを確実に移行できるツールとチェックプロセスを整備し、品質を担保する。
5. **開発者と編集者の共存**: CLI UX とドキュメントを整備し、エンジニア以外の利用者でも運用可能なフローを提供する。

## 3. 開発・運用原則
- レジストリ（JSON）を単一ソース・オブ・トゥルースとし、生成サイト・CLI・テストが同じデータ定義を参照する。
- CLI は冪等性とロールバック性を重視し、失敗時のリカバリー手順を明示する。
- ビルドは 1 回で完結するパイプラインを基準とし、必要に応じて前処理/後処理を追加しても構成を複雑化させない。
- UI/テーマ資産は独立パッケージ化し、バージョン管理と互換性情報を明示する。
- Cloudflare Pages を想定したビルド成果物の構造・ルーティング・キャッシュ戦略を標準化する。
- 重大な仕様変更時はフェーズ文書・概要に必ず反映し、影響範囲と対応策を記録する。

## 4. コンテンツ運用原則
- プロジェクト/バージョン/言語/カテゴリー/ドキュメント ID をレジストリで宣言的に管理する。
- CLI は docId・スラッグ・翻訳ステータスを自動生成し、一貫性チェックを常に行う。
- 翻訳やレビュー状況を可視化するフィールドをレジストリに用意し、未完了状態を検知できるようにする。
- コンテンツ本文（MDX）は docId 別ディレクトリで管理し、言語差分のみをファイルとして保持する。
- 運用ドキュメント（ワークフロー、FAQ、手順書）は `docs/new-generator-plan` 以下に集約し、更新状況を管理する。

## 5. 自動化と品質保証
- JSON スキーマ検証、リンクチェック、ビルド検証を CI で自動化し、エラーはパイプラインで即座に検知する。
- CLI コマンドには `--dry-run` / `--validate` オプションを標準装備し、安全に変更内容を確認できるようにする。
- ビルド成果物はアクセシビリティ・パフォーマンスの定期計測を行い、指標化して改善サイクルに組み込む。
- マイグレーションツールは差分レポートを生成し、レビュー前提での承認フローを整備する。

## 6. コラボレーションとナレッジ共有
- 設計・実装・運用に関する決定事項は `docs/new-generator-plan` 配下で文書化し、バージョン管理に乗せる。
- フェーズごとの完了条件とレビュー結果を記録し、次フェーズのインプットとして再利用する。
- コード・ドキュメント・CLI の変更は常に関連ドキュメントを更新し、情報の分散を避ける。
- 利用チームからのフィードバックを定期的に収集し、フェーズ5の改善バックログへ反映する。

## 7. 法務・ライセンス
- 翻訳元のライセンス確認を徹底し、再配布可否と帰属表示をレジストリに明記する。
- 共有パッケージ化する UI/テーマは OSS ライセンス遵守と再配布条件の整理を行い、利用者に明示する。
- 外部サービス連携時は必要な契約や利用条件を確認し、ドキュメントへ記録する。

## 8. 見直しとアップデート
- 各フェーズ完了時に本原則をレビューし、新たな知見や課題を反映する。
- 実装仕様と乖離が発生した場合は速やかに更新し、理由と影響範囲を追記する。
- 年次または大規模リリース前に総合レビューを実施し、必要に応じて改訂版を公開する。

---
本原則は新ドキュメントサイトジェネレーターの初期草案であり、プロジェクトの進行に合わせて進化させていくことを想定している。
