---
import { getLegacyProjectConfig, initializeConfig } from '../../lib/config';
import type { LocaleKey } from '@docs/i18n/locales';
import { generateRedirectUrl } from '../../utils/dynamic-navigation';

export async function getStaticPaths() {
  // getStaticPaths内で設定を初期化
  await initializeConfig();
  const projectConfig = await getLegacyProjectConfig();
  
  return projectConfig.versions.map(v => ({
    params: { version: v.id }
  }));
}

const { version: versionParam } = Astro.params;
const version = versionParam || 'v1';

// 設定を再度初期化（プロパティセクション）
await initializeConfig();
const projectConfig = await getLegacyProjectConfig();
const baseUrl = projectConfig.baseUrl;

// デフォルト言語でリダイレクト
const defaultLang = projectConfig.defaultLocale || 'en';
const redirectUrl = `${baseUrl}/${version}/${defaultLang}/`;

// リダイレクトを実行
return Astro.redirect(redirectUrl);
---

<!-- このページは動的リダイレクトのため、HTMLコンテンツは不要 -->
